\subsection*{REST API Details}

The following section provides documentation for all RESTful endpoints in the Bookly system. Each entry describes its purpose, HTTP method, required parameters, and both success and error responses.

% === AUTH ===
\subsubsection*{User Authentication}

\textbf{Sign Up} \\
Registers a new user with profile data.
– URL: /auth/signup \\
– Method: POST \\
– URL Parameters: NONE \\
– Data Parameters: username, email, password, firstName, lastName, phone, address \\
– Success Response: \\
Code: 201 \\
Content: \{"message": "User created successfully."\} \\
– Error Response: \\
Code: 400 Bad Request \\
Content: \{"error": "Missing required fields"\} \\
When: Required fields are missing \\
Code: 409 Conflict \\
Content: \{"error": "Username or email already exists."\} \\
When: Username/email already registered

\textbf{Login} \\
Authenticates a user and returns a JWT.
– URL: /auth/login \\
– Method: POST \\
– URL Parameters: NONE \\
– Data Parameters: username, password \\
– Success Response: \\
Code: 200 OK \\
Content: \{"token": "jwtToken"\} \\
– Error Response: \\
Code: 400 Bad Request \\
Content: \{"error": "Missing credentials"\} \\
When: Username or password is missing \\
Code: 401 Unauthorized \\
Content: \{"error": "Invalid credentials."\} \\
When: Login failed

\textbf{Logout} \\
Logs out the current user session.
– URL: /auth/logout \\
– Method: GET \\
– URL Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: Redirect to home

% === BOOKS ===
\subsubsection*{Books}

\textbf{Get All Books} \\
Fetch all books in the catalog.
– URL: /books \\
– Method: GET \\
– Success Response: \\
Code: 200 OK \\
Content: [book_list]

\textbf{Get Book by ID} \\
Retrieve a single book by its ID.
– URL: /book?id={book_id} \\
– Method: GET \\
– Success Response: \\
Code: 200 OK \\
Content: {book details} \\
– Error Response: \\
Code: 404 Not Found \\
Content: \{"error": "Book not found."\}

\textbf{Search Books} \\
Find books matching a title keyword.
– URL: /books/search?title={query} \\
– Method: GET \\
– Success Response: \\
Code: 200 OK \\
Content: [matched_books] \\
– Error Response: \\
Code: 404 Not Found \\
Content: \{"error": "No matches."\}

\textbf{Top Rated Books} \\
List top-rated books.
– URL: /books/top-rated \\
– Method: GET \\
– Success Response: \\
Code: 200 OK \\
Content: [top_books]

\textbf{Insert Book} \\
Creates a new book entry.
– URL: /book \\
– Method: POST \\
– Data Parameters: title, price, author_id, publisher_id, isbn, language, ... \\
– Success Response: \\
Code: 201 Created \\
Content: \{"message": "Book created."\} \\
– Error Response: \\
Code: 400 Bad Request \\
Content: \{"error": "Missing book fields."\}

\textbf{Update Book} \\
Updates a book record.
– URL: /book \\
– Method: PUT \\
– Data Parameters: bookId, title, price, etc. \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Book updated."\}

\textbf{Delete Book} \\
Deletes a book.
– URL: /book?id={book_id} \\
– Method: DELETE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Book deleted."\}

\textbf{Update Book Stock} \\
Adjusts stock for a book.
– URL: /book/stock?id={book_id}&quantity={qty} \\
– Method: PUT \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Stock updated."\}

% === AUTHORS ===
\subsubsection*{Authors}

\textbf{Get All Authors} \\
Retrieves a list of all authors.
– URL: /authors \\
– Method: GET \\
– Success Response: \\
Code: 200 OK \\
Content: [author_list]

\textbf{Get Author by ID} \\
Returns a specific author's information.
– URL: /authors/{id} \\
– Method: GET \\
– URL Parameters: id = author ID \\
– Success Response: \\
Code: 200 OK \\
Content: {author_details} \\
– Error Response: \\
Code: 404 Not Found \\
Content: \{"error": "Author not found."\}

\textbf{Create Author} \\
Adds a new author.
– URL: /authors \\
– Method: POST \\
– Data Parameters: first_name, last_name, biography, nationality \\
– Success Response: \\
Code: 201 Created \\
Content: \{"message": "Author created."\}

\textbf{Update Author} \\
Modifies an existing author.
– URL: /authors/{id} \\
– Method: PUT \\
– URL Parameters: id = author ID \\
– Data Parameters: first_name, last_name, biography, nationality \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Author updated."\}

\textbf{Delete Author} \\
Removes an author.
– URL: /authors/{id} \\
– Method: DELETE \\
– URL Parameters: id = author ID \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Author deleted."\}

\textbf{Assign Author to Book} \\
Links an author to a book.
– URL: /authors/assign \\
– Method: POST \\
– Data Parameters: bookId, authorId \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Author assigned."\}

\textbf{Remove Author from Book} \\
Unlinks an author from a book.
– URL: /authors/remove \\
– Method: DELETE \\
– Data Parameters: bookId, authorId \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Author removed."\}

% === PUBLISHERS ===
\subsubsection*{Publishers}

\textbf{Insert Publisher} \\
– URL: /publishers \\
– Method: POST \\
– URL Parameters: NONE \\
– Data Parameters: publisher_name, phone, address \\
– Success Response: \\
Code: 201 Created \\
Content: \{"message": "Publisher inserted successfully."\} \\
– Error Response: \\
Code: 500 Internal Server Error \\
Content: \{"error": "Failed to insert publisher."\}

\textbf{Update Publisher} \\
– URL: /publishers/{id} \\
– Method: PUT \\
– URL Parameters: id = publisher ID \\
– Data Parameters: publisher_name, phone, address \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Publisher updated successfully."\} \\
– Error Response: \\
Code: 404 Not Found \\
Content: \{"error": "Publisher not found."\}

\textbf{Delete Publisher} \\
– URL: /publishers/{id} \\
– Method: DELETE \\
– URL Parameters: id = publisher ID \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Publisher deleted successfully."\}


% === CART ===
\subsubsection*{Cart}

\textbf{Retrieve Cart by User ID} \\
– URL: /cart?userId={user_id} \\
– Method: GET \\
– URL Parameters: userId = user ID \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{cart_details\} \\
– Error Response: \\
Code: 404 Not Found \\
Content: \{"error": "Cart not found."\}

\textbf{Add Book to Cart} \\
– URL: /cart/add?cartId={cart_id}&bookId={book_id} \\
– Method: POST \\
– URL Parameters: cartId, bookId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Book added to cart."\}

\textbf{Remove Book from Cart} \\
– URL: /cart/remove?cartId={cart_id}&bookId={book_id} \\
– Method: DELETE \\
– URL Parameters: cartId, bookId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Book removed from cart."\}

% === WISHLIST ===
\subsubsection*{Wishlist}

\textbf{Create Wishlist} \\
– URL: /wishlist?userId={user_id} \\
– Method: POST \\
– URL Parameters: userId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 201 Created \\
Content: \{"message": "Wishlist created successfully."\}

\textbf{Delete Wishlist} \\
– URL: /wishlist/{wishlistId} \\
– Method: DELETE \\
– URL Parameters: wishlistId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Wishlist deleted."\}

\textbf{Add Book to Wishlist} \\
– URL: /wishlist/books/add \\
– Method: POST \\
– URL Parameters: NONE \\
– Data Parameters: wishlistId, bookId \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Book added to wishlist."\}

\textbf{Remove Book from Wishlist} \\
– URL: /wishlist/books/remove \\
– Method: DELETE \\
– URL Parameters: NONE \\
– Data Parameters: wishlistId, bookId \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Book removed from wishlist."\}

\textbf{Get Wishlist Books} \\
– URL: /wishlist/books/{wishlistId} \\
– Method: GET \\
– URL Parameters: wishlistId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{[book_1, book_2, ...]\}

\textbf{Count Books in Wishlist} \\
– URL: /wishlist/books/count?wishlistId={wishlistId} \\
– Method: GET \\
– URL Parameters: wishlistId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"count": X\}

% === ORDERS ===
\subsubsection*{Orders}

\textbf{Get All Orders} \\
– URL: /orders \\
– Method: GET \\
– URL Parameters: NONE \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: [ \{ order_1 \}, \{ order_2 \}, ... ]

\textbf{Get Order by ID} \\
– URL: /order/{id} \\
– Method: GET \\
– URL Parameters: id = order ID \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{order_details\}

\textbf{Insert Order} \\
– URL: /order \\
– Method: POST \\
– URL Parameters: NONE \\
– Data Parameters: total_price, payment_method, address, status, cart_id (optional) \\
– Success Response: \\
Code: 201 Created \\
Content: \{"message": "Order created."\}

\textbf{Get User Orders} \\
– URL: /order/user/{userId} \\
– Method: GET \\
– URL Parameters: userId = user ID \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: [ \{ order_1 \}, \{ order_2 \} ]

\textbf{Get Latest Order for User} \\
– URL: /order/user/{userId}/latest \\
– Method: GET \\
– URL Parameters: userId = user ID \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{latest_order\}

% === DISCOUNTS ===
\subsubsection*{Discounts}

\textbf{Get All Discounts} \\
– URL: /discount/all \\
– Method: GET \\
– URL Parameters: NONE \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: [ \{discounts\} ]

\textbf{Get Active Discounts} \\
– URL: /discount/active \\
– Method: GET \\
– URL Parameters: NONE \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: [ \{active_discounts\} ]

\textbf{Get Discount by Code} \\
– URL: /discount/code?code={discount_code} \\
– Method: GET \\
– URL Parameters: code = discount code \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{discount\}

\textbf{Get Valid Discount by Code} \\
– URL: /discount/query/valid?code={discount_code} \\
– Method: GET \\
– URL Parameters: code = discount code \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{discount\}

\textbf{Delete Discount} \\
– URL: /discount?id={discount_id} \\
– Method: DELETE \\
– URL Parameters: id = discount ID \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Discount deleted."\}


% === User ===
\subsubsection*{User}
\textbf{Get User by Username} \\
– URL: /user?username={username} \\
– Method: GET \\
– URL Parameters: username \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content: \{user\_data\}

\textbf{Update User Profile} \\
– URL: /user/update \\
– Method: PUT \\
– URL Parameters: NONE \\
– Data Parameters: user_id, first_name, last_name, email, phone, address, role \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "User updated."\}

\textbf{Change Password} \\
– URL: /user/password \\
– Method: PUT \\
– URL Parameters: NONE \\
– Data Parameters: user_id, new_password \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Password changed successfully."\}

\textbf{Upload/Update Profile Image} \\
– URL: /user/image \\
– Method: POST \\
– URL Parameters: NONE \\
– Data Parameters: user_id, image (multipart) \\
– Success Response: \\
Code: 200 OK \\
Content: \{"message": "Image uploaded."\}

\textbf{Get User Image} \\
– URL: /user/image?userId={id} \\
– Method: GET \\
– URL Parameters: userId \\
– Data Parameters: NONE \\
– Success Response: \\
Code: 200 OK \\
Content-Type: image/jpeg (or image/png)